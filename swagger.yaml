swagger: "2.0"
info:
  title: dp-bulletin-api
  description: "Bulletin API for ONS digital publishing"
  version: 1.0.0
  license:
    name: "Open Government Licence v3.0"
    url: "http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/"
basePath: "/v1"
schemes:
  - http
tags:
  - name: "Public"
paths:
  /bulletins:
    get:
      tags:
        - "Public"
      summary: Get a list of buletins
      description: (future implementation)
      parameters:
        - $ref: '#/parameters/limit'
        - $ref: '#/parameters/offset'
      produces:
        - application/json
      responses:
        501:
          description: Not Implemented
        200:
          description: OK
          schema:
            $ref: '#/definitions/BulletinsList'

  /bulletins/{id}:
    get:
      tags:
        - "Public"
      summary: Get a bulletin
      parameters:
        - $ref: '#/parameters/id'
      produces:
        - application/json
      responses:
        200:
          description: OK
          schema:
            $ref: '#/definitions/Bulletin'

  /bulletins/{id}/editions:
    get:
      tags:
        - "Public"
      summary: Get a list of editions of a bulletin
      parameters:
        - $ref: '#/parameters/id'
        - $ref: '#/parameters/limit'
        - $ref: '#/parameters/offset'
      produces:
        - application/json
      responses:
        200:
          description: OK
          schema:
            $ref: '#/definitions/EditionsList'

  /bulletins/{id}/editions/{edition}:
    get:
      tags:
        - "Public"
      summary: Get an edition of a bulletin
      parameters:
        - $ref: '#/parameters/id'
        - $ref: '#/parameters/edition'
      produces:
        - application/json
      responses:
        200:
          description: OK
          schema:
            $ref: '#/definitions/Edition'

  /bulletins/{id}/editions/{edition}/versions:
    get:
      tags:
        - "Public"
      summary: Get a list of versions of an edition
      parameters:
        - $ref: '#/parameters/id'
        - $ref: '#/parameters/edition'
        - $ref: '#/parameters/limit'
        - $ref: '#/parameters/offset'
      description: (future implementation)
      produces:
        - application/json
      responses:
        501:
          description: Not Implemented
        200:
          description: OK
          schema:
            $ref: '#/definitions/VersionsList'

  /bulletins/{id}/editions/{edition}/versions/{version}:
    get:
      tags:
        - "Public"
      summary: Get a version
      parameters:
        - $ref: '#/parameters/id'
        - $ref: '#/parameters/edition'
        - $ref: '#/parameters/version'
      produces:
        - application/json
      responses:
        200:
          description: OK
          schema:
            $ref: '#/definitions/Version'

parameters:
  id:
    name: id
    description: ID of a bulletin
    type: string
    in: path
    required: true
  edition:
    name: id
    description: Edition of a bulletin
    type: string
    in: path
    required: true
  version:
    name: id
    description: Version of a bulletin
    type: string
    in: path
    required: true
  limit:
    name: limit
    description: The number of items requested, defaulted to 50 and limited to 1000.
    type: integer
    required: false
    in: query
  offset:
    name: offset
    description: The first row of resources to retrieve, starting at 0. Use this parameter as a pagination mechanism along with the limit parameter.
    type: integer
    required: false
    in: query

definitions:
  BulletinsList:
    type: object
    properties:
      count:
        $ref: '#/definitions/itemCount'
      items:
        type: array
        items:
          $ref: '#/definitions/BulletinsListItem'

  BulletinsListItem:
    type: object
    properties:
      id:
        $ref: '#/definitions/id'

  Bulletin:
    type: object
    properties:
      id:
        $ref: '#/definitions/id'
      contacts:
        type: array
        items:
          $ref: '#/definitions/Contact'
      description:
        $ref: '#/definitions/summary'
      keywords:
        type: array
        description: List of keywords relating to this bulletin
        items:
          type: string
        example: [ "work" , "jobless" ]
      license:
        description: "The standard Government license right text for the bulletin"
        type: string
      national_statistic:
        $ref: '#/definitions/nationalStatistic'
      next_release:
        $ref: '#/definitions/nextRelease'
      title:
        $ref: '#/definitions/title'
      links:
        type: object
        properties:
          self:
            $ref: '#/definitions/Link'
          latest_edition:
            $ref: '#/definitions/Link'
          versions:
            $ref: '#/definitions/Link'
          latest_version:
            $ref: '#/definitions/Link'

  EditionsList:
    type: object
    properties:
      id:
        $ref: '#/definitions/id'
      count:
        $ref: '#/definitions/itemCount'
      items:
        type: array
        items:
          $ref: '#/definitions/EditionsListItem'

  EditionsListItem:
    type: object
    properties:
      edition:
        $ref: '#/definitions/edition'


  Edition:
    type: object
    properties:
      id:
        $ref: '#/definitions/id'
      edition:
        $ref: '#/definitions/edition'
      links:
        type: object
        properties:
          self:
            $ref: '#/definitions/Link'
          bulletin:
            $ref: '#/definitions/Link'
          versions:
            $ref: '#/definitions/Link'
          latest_version:
            $ref: '#/definitions/Link'


  VersionsList:
    type: object
    properties:
      id:
        $ref: '#/definitions/id'
      edition:
        $ref: '#/definitions/edition'
      count:
        $ref: '#/definitions/itemCount'
      items:
        type: array
        items:
          $ref: '#/definitions/VersionsListItem'

  VersionsListItem:
    type: object
    properties:
      version:
        type: string
        description: Version number
        example: "2"
      correction_notice:
        type: string
        example: "A correction has been ma…gise for any inconvenience."
      update_date:
        type: string
        format: 'date-time'
        example: "2019-11-12T15:53:59.810Z"
      uri:
        type: string
        example: "/employmentandlabourmarket/peopl…er2019/previous/v2"


  Version:
    type: object
    properties:
      id:
        $ref: '#/definitions/id'
      edition:
        $ref: '#/definitions/edition'
      version:
        $ref: '#/definitions/version'
      charts:
        type: array
        items:
          $ref: '#/definitions/FigureSection'
      equations:
        type: array
        items:
          $ref: '#/definitions/FigureSection'
      headlines:
        type: array
        description: Headlines from this bulletin
        maxItems: 3
        items:
          type: string
          example: "Headline about this bulletin"
      images:
        type: array
        items:
          $ref: '#/definitions/FigureSection'
      bulletin_links:
        type: array
        items:
          $ref: '#/definitions/BulletinLink'
      meta_description:
        type: string
        example: "Estimates of employment… statistics for the UK."
      related_data:
        type: array
        items:
          $ref: '#/definitions/BulletinLink'
      related_documents:
        type: array
        items:
          $ref: '#/definitions/BulletinLink'
      related_methodologies:
        type: array
        items:
          $ref: '#/definitions/BulletinLink'
      related_methodology_articles:
        type: array
        items:
          $ref: '#/definitions/BulletinLink'
      sections:
        type: array
        items:
          $ref: '#/definitions/ContentSection'
      summary:
        $ref: '#/definitions/summary'
      tables:
        type: array
        items:
          $ref: '#/definitions/FigureSection'
      topics:
        type: array
        items:
          $ref: '#/definitions/BulletinLink'
      links:
        type: object
        properties:
          self:
            $ref: '#/definitions/Link'
          bulletin:
            $ref: '#/definitions/Link'
          versions:
            $ref: '#/definitions/Link'

  Contact:
    type: object
    properties:
      email:
        type: string
        example: "joe.bloggs@ons.gov.uk"
      name:
        type: string
        example: "Joe Bloggs"
      telephone:
        type: string
        example: "+44 (0)845 601 3034"

  ContentSection:
    type: object
    properties:
      title:
        type: string
        description: Title of the section
        example: "Section Title"
      content:
        type: string
        description: Markdown formatted content for the section
        example: "Some _content_ in [Markdown](https://en.wikipedia.org/wiki/Markdown)"

  FigureSection:
    type: object
    properties:
      filename:
        type: string
        description: Filename of the chart / equation / image / table
        example: "57ec16d6"
      title:
        type: string
        description: Title of the chart / equation / image / table
        example: "A Short Title"
      uri:
        type: string
        description: URI for the chart / equation / image / table
        example: "/location/of/item"
      version:
        type: string
        description: Version
        example: "2"

  BulletinLink:
    type: object
    properties:
      index:
        type: integer
      title:
        type: string
      uri:
        type: string

  Link:
    type: object
    properties:
      href:
        type: string
        format: uri
      id:
        type: string
    required:
      - href

  id:
    type: string
    description: id of the bulletin
    example: "uklabourmarket"
  edition:
    type: string
    description: edition of the bulletin
    example: "November 2019"
  version:
    type: string
    description: Particular version
    example: "1"
  itemCount:
    type: integer
    description: count of items returned in list
    example: 25

  nationalStatistic:
    type: boolean
    description: Indicates that this bulletin refers to a National Statistic. These are certified as compliant with the Code of Practice for Official Statistics.
    example: true
  nextRelease:
    type: string
    description: Date of the next expected release
    example: "17 December 2019"
  summary:
    type: string
    description: A summary of the bulletin
    example: "Estimates of employment… statistics for the UK."
  title:
    type: string
    description: The title of the bulletin
    example: "Labour market overview, UK"